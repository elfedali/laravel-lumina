import{M as u,a as p}from"./admin-PnUScFU-.js";const g=new u(document.getElementById("appCompanyModal")),y=document.getElementById("appCompanyModal");y.addEventListener("hidden.bs.modal",f=>{});y.addEventListener("show.bs.modal",f=>{});$(function(){const f=$("#btnEditCompany"),i=$("#appCompanyModalDialog"),s=$('meta[name="csrf-token"]');f.on("click",function(){const l=$(this).data("id");console.log("Editing company with ID:",l),$.ajax({url:`/changes/companies/${l}/edit`,type:"GET",success:function(n){if(i.html(n),!document.getElementById("appCompanyModalDialog")){console.error("Modal element not found!");return}g.show(),r(g)},error:function(n,e,t){console.error("Error fetching company edit form:",t)}})});function r(l){const n=$("#formUpdateCompany");n.off("submit").on("submit",function(e){e.preventDefault();const t=n.find('[type="submit"]'),o=$(".company-name-error"),a=$(".company-category-error"),d=$("#company_name"),c=$("#company_category"),v=$("#company_logo"),b=$(".company-logo-error");t.prop("disabled",!0),o.text(""),a.text(""),d.removeClass("is-invalid"),c.removeClass("is-invalid"),$.ajax({url:n.attr("action"),type:"POST",data:new FormData(n[0]),headers:{"X-CSRF-TOKEN":s.attr("content")},processData:!1,contentType:!1,enctype:"multipart/form-data",success:function(m){l.hide(),location.reload()},error:function(m,C,E){console.log("XHR:",m),m.responseJSON&&m.responseJSON.errors?(m.responseJSON.errors.name&&(o.text(m.responseJSON.errors.name[0]),d.addClass("is-invalid")),m.responseJSON.errors.category&&(a.text(m.responseJSON.errors.category[0]),c.addClass("is-invalid")),m.responseJSON.errors.logo&&(b.text(m.responseJSON.errors.logo[0]),v.addClass("is-invalid"))):alert("An unexpected error occurred. Please try again later.")},complete:function(){t.prop("disabled",!1)}})})}});const h=new u(document.getElementById("appLocaleModal"));$(function(){$("#btnNewLocale").on("click",function(){p.get("/changes/locales/create").then(s=>{document.getElementById("appLocaleModalDialog").innerHTML=s.data,i(),h.show()})});function i(){const s=$("#formCreateLocale");s.on("submit",function(r){r.preventDefault();const l=s.find('[type="submit"]');l.prop("disabled",!0),$(".is-invalid").removeClass("is-invalid"),$(".invalid-feedback").text(""),p.post(s.attr("action"),s.serialize()).then(n=>{h.hide(),location.reload()}).catch(n=>{if(n.response&&n.response.status===422){const e=n.response.data.errors;for(const t in e){const o=$(`[name="${t}"]`);if(o.length&&(o.addClass("is-invalid"),o.after(`<div class="invalid-feedback">${e[t][0]}</div>`)),t.startsWith("hours.")){const a=t.split(".");if(a.length===3){const d=a[1],c=a[2],v=$(`[name="hours[${d}][${c}]"]`);v.addClass("is-invalid"),v.after(`<div class="invalid-feedback">${e[t][0]}</div>`)}}if(t==="hours"){const a=`<div class="invalid-feedback d-block mb-3">${e[t][0]}</div>`;console.log(a),s.find(".hoursSection").prepend(a)}}}else console.error("Form submission error:",n)}).finally(()=>{l.prop("disabled",!1)})})}});$(function(){$(document).on("click","[id^='edit-locale-']",function(){const i=$(this).data("id");p.get(`/changes/locales/${i}/edit-form`).then(s=>{const r=new u("#appModalEditLocale");$("#appModalEditLocaleDialog").html(s.data),console.log(s.data),f(),r.show()})});function f(){const i=$("#formEditLocale");i.on("submit",function(s){s.preventDefault();const r=i.find('[type="submit"]');r.prop("disabled",!0),$(".is-invalid").removeClass("is-invalid"),$(".invalid-feedback").remove(),p.post(i.attr("action"),i.serialize()).then(l=>{h.hide(),location.reload()}).catch(l=>{if(r.prop("disabled",!1),l.response&&l.response.status===422){const n=l.response.data.errors;for(const e in n){const t=$(`[name="${e}"]`);if(t.length&&(t.addClass("is-invalid"),t.after(`<div class="invalid-feedback">${n[e][0]}</div>`)),e.startsWith("hours.")){const o=e.split(".");if(o.length===3){const a=o[1],d=o[2],c=$(`[name="hours[${a}][${d}]"]`);c.addClass("is-invalid"),c.after(`<div class="invalid-feedback">${n[e][0]}</div>`)}}if(e==="hours"){const o=`<div class="invalid-feedback d-block mb-3">${n[e][0]}</div>`;console.log(o),i.find(".hoursSection").prepend(o)}}}else console.error("Form submission error:",l)})})}$(document).on("click","[id^='delete-locale-']",function(){const i=$(this).data("id");p.get(`/changes/locales/${i}/destroy-form`).then(s=>{const r=new u("#appDeleteLocaleModal");$("#appDeleteLocaleModalDialog").html(s.data),r.show()})})});$(function(){let f=$(".classBtnDeleteClient");for(let n of f)n.addEventListener("click",async function(){const e=this.dataset.id,t=this.dataset.name;$("#clientNameTodelete").text(t),$("#clientIdTodelete").val(e)});const i=$("#addClientModal"),s=new u(i);i.hasClass("modalHasErrors")&&s.show();const r=$(".classBtnEditClient"),l=new u(document.getElementById("editClientModal"));for(let n of r)n.addEventListener("click",async function(){l.show(),console.log(this.dataset);let e=this.dataset.id,t=this.dataset.first_name,o=this.dataset.last_name,a=this.dataset.email,d=this.dataset.phone;const c=$("#editClientForm");c.find(".is-invalid").removeClass("is-invalid"),c.find(".invalid-feedback").text(""),c.find('[name="id"]').val(e),c.find('[name="first_name"]').val(t),c.find('[name="last_name"]').val(o),c.find('[name="email"]').val(a),c.find('[name="phone"]').val(d)});$("#editClientForm").on("submit",function(n){n.preventDefault();const e=$(this);p.put(e.attr("action"),e.serialize()).then(t=>{console.log(t),l.hide(),location.reload()}).catch(t=>{if(e.find(".is-invalid").removeClass("is-invalid"),e.find(".invalid-feedback").text(""),t.response.status===422){const o=t.response.data.errors;for(const a in o){const d=e.find(`[name="${a}"]`);d.length&&(d.addClass("is-invalid"),d.after(`<div class="invalid-feedback">${o[a][0]}</div>`))}}})}),$("#addClientForm").on("submit",function(n){n.preventDefault();const e=$(this);p.post(e.attr("action"),e.serialize()).then(t=>{console.log(t),s.hide(),location.reload()}).catch(t=>{if(e.find(".is-invalid").removeClass("is-invalid"),e.find(".invalid-feedback").text(""),t.response.status===422){const o=t.response.data.errors;for(const a in o){const d=e.find(`[name="${a}"]`);d.length&&(d.addClass("is-invalid"),d.after(`<div class="invalid-feedback">${o[a][0]}</div>`))}}})})});
